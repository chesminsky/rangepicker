!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/forms"),require("moment"),require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("@sgv/rangepicker",["exports","@angular/forms","moment","@angular/common","@angular/core"],t):t((e.sgv=e.sgv||{},e.sgv.rangepicker={}),e.ng.forms,e.moment_,e.ng.common,e.ng.core)}(this,function(e,t,r,n,a){"use strict";var i=new a.InjectionToken("options"),s=function(){function e(e){this.options=e;Object.assign(this,{color:"#3f51b5",format:"DD.MM.YYYY"}),e&&Object.assign(this,e)}return e.decorators=[{type:a.Injectable}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:a.Inject,args:[i]},{type:a.Optional}]}]},e}(),o=r,d=function(){function e(e,t){this.elemRef=e,this.defaults=t,this.windowClick=this.windowClick.bind(this)}return e.prototype.writeValue=function(e){e&&(this.value=e,this.elemRef.nativeElement.value=e)},e.prototype.registerOnChange=function(e){var t=this;this.onChange=function(){e(t.value)}},e.prototype.registerOnTouched=function(e){},e.prototype.ngAfterViewInit=function(){var n=this;this.processChange(this.elemRef.nativeElement.value),this.sgvRangepicker.init(),this.sub=this.sgvRangepicker.datesChanged.subscribe(function(e){var t=Number(e.start),r=Number(e.end);n.writeValue(o(t).format(n.defaults.format)+" - "+o(r).format(n.defaults.format)),n.onChange()}),window.addEventListener("click",this.windowClick)},e.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),window.removeEventListener("click",this.windowClick)},e.prototype.onclick=function(e){e.stopPropagation(),this.sgvRangepicker.show()},e.prototype.onInput=function(e){var t=e.target.value;this.processChange(t)},e.prototype.processChange=function(e){if(e){var t=e.split(" - "),r=o(t[0],this.defaults.format),n=o(t[1],this.defaults.format);r.isValid()&&n.isValid()&&r.valueOf()<=n.valueOf()?this.sgvRangepicker.period={start:r.valueOf(),end:n.valueOf()}:(this.sgvRangepicker.period={},this.sgvRangepicker.hide())}else!0,this.sgvRangepicker.period={}},e.prototype.windowClick=function(){this.sgvRangepicker.hide()},e.decorators=[{type:a.Directive,args:[{selector:"[sgvRangepicker]",providers:[{provide:t.NG_VALUE_ACCESSOR,useExisting:e,multi:!0}]}]}],e.ctorParameters=function(){return[{type:a.ElementRef},{type:undefined,decorators:[{type:a.Inject,args:[s]}]}]},e.propDecorators={sgvRangepicker:[{type:a.Input}],onclick:[{type:a.HostListener,args:["click",["$event"]]}],onInput:[{type:a.HostListener,args:["input",["$event"]]}]},e}(),c=r,l=function(){function e(e,t){this.locale=e,this.defaults=t,this.headings=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"]}return e.prototype.ngOnInit=function(){var t=this;this.monthIndex=c().month(),this.year=c().year(),"left"===this.side&&this.decMonth(),this.init(),this.events.on("navigate",function(e){"prev"===e?t.decMonth():"next"===e&&t.incMonth(),t.init()})},e.prototype.getMonthTitle=function(){var e=this.month.locale(this.locale).format("MMMM, YYYY");return e.charAt(0).toUpperCase()+e.slice(1)},e.prototype.navigate=function(e){this.events.send("navigate",e)},e.prototype.select=function(e){e.isCurrentMonth&&this.events.send("updateModel",e.date)},e.prototype.onHover=function(e){e.isCurrentMonth&&this.events.send("hovered",e.date)},e.prototype.isSelected=function(e){var t=Number(this.period.start),r=Number(this.period.end);return t&&e.isSame(t,"day")||r&&e.isSame(r,"day")},e.prototype.isBetween=function(e){var t=Number(this.period.start),r=Number(this.period.end),n=Number(this.hoveredDate);return t&&r?e.isBetween(t,r):t&&n?e.isBetween(t,n)||e.isBetween(n,t)||e.valueOf()===n:void 0},e.prototype.init=function(){this.month=c([this.year,this.monthIndex]),this.firstMonday=c([this.year,this.monthIndex]).startOf("isoWeek"),this.weeks=this.buildCalendar()},e.prototype.buildCalendar=function(){for(var e=[],t=!1,r=this.firstMonday.clone();!t;)e.push({days:this.buildWeek(r.clone())}),r.add(1,"w"),t=this.monthIndex!==r.month();return e},e.prototype.buildWeek=function(e){for(var t=[],r=0;r<7;r++)t.push({name:e.format("dd").substring(0,1),number:e.date(),isCurrentMonth:e.month()===this.monthIndex,isToday:e.isSame(new Date,"day"),date:e}),(e=e.clone()).add(1,"d");return t},e.prototype.incMonth=function(){this.monthIndex++,12===this.monthIndex&&(this.monthIndex=0,this.year++)},e.prototype.decMonth=function(){this.monthIndex--,-1===this.monthIndex&&(this.monthIndex=11,this.year--)},e.decorators=[{type:a.Component,args:[{selector:"sgv-calendar",template:'<div class="m-calendar">\r\n\t<header class="m-calendar__header">\r\n\t\t<div class="m-calendar__nav m-calendar__nav--left">\r\n\t\t\t<i (click)="navigate(\'prev\')" *ngIf="side !== \'right\'"></i>\r\n\t\t</div>\r\n\t\t<div class="m-calendar__title" >\r\n\t\t\t{{ getMonthTitle() }}\r\n\t\t</div>\r\n\t\t<div class="m-calendar__nav m-calendar__nav--right">\r\n\t\t\t<i (click)="navigate(\'next\')" *ngIf="side !== \'left\'"></i>\r\n\t\t</div>\r\n\t</header>\r\n\r\n\t<table>\r\n\t\t<thead>\r\n\t\t\t<th *ngFor="let th of headings">{{th}}</th>\r\n\t\t</thead>\r\n\t\t<tbody>\r\n\t\t\t<tr *ngFor="let week of weeks">\r\n\t\t\t\t<td *ngFor="let day of week.days" \r\n\t\t\t\t\t(click)="select(day)"\r\n\t\t\t\t\t(mouseover)="onHover(day);">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<span class="m-calendar__day"\r\n\t\t\t\t\t\t  [ngClass]="{\r\n\t\t\t\t\t\t\t\t\t\'is-today\': day.isToday,\r\n\t\t\t\t\t\t\t\t\t\'is-selected\': isSelected(day.date)\r\n\t\t\t\t\t\t\t\t\t}"\r\n\t\t\t\t\t\t  [ngStyle]="isBetween(day.date) ? {\'color\': defaults.color} : {}"\r\n\t\t\t\t\t\t  *ngIf="day.isCurrentMonth">\r\n\t\t\t\t\t\t{{day.number}}\r\n\t\t\t\t\t\t<span class="m-calendar__selected-day"\r\n\t\t\t\t\t\t\t  [ngStyle]="isSelected(day.date) ? {\'background-color\': defaults.color, \'display\': \'block\'} : {}"></span>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n</div>\r\n',styles:[".m-calendar{width:100%}.m-calendar__header{display:table;width:100%;height:60px;table-layout:fixed}.m-calendar__nav{display:table-cell;width:50px;vertical-align:middle}.m-calendar__nav--left{text-align:left}.m-calendar__nav--left i{display:inline-block;width:24px;height:24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAAN0lEQVR4AWOgEIyCBiAkSfl/ht8MWqQpDyFNeShpysNIUf4HpJw0DeFA1nDRokWaljry0tQoAABoiB3OU+DRDgAAAABJRU5ErkJggg==)}.m-calendar__nav--right{text-align:right}.m-calendar__nav--right i{display:inline-block;width:24px;height:24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAANElEQVR4AWMgE4yCRoYGUpTrMvxh+E+algjStUSSriWKdC3REC2UaBh45TSMuAYgpAiMAgDU3h38ltq8/gAAAABJRU5ErkJggg==)}.m-calendar__nav i{margin:0 8px;cursor:pointer;vertical-align:middle}.m-calendar__title{display:table-cell;font-size:14px;font-weight:500;text-align:center;vertical-align:middle}.m-calendar table{width:100%}.m-calendar table td,.m-calendar table th{height:34px;font-size:12px;font-weight:500;text-align:center}.m-calendar table th{color:#9e9e9e}.m-calendar table td{cursor:pointer}.m-calendar__day{position:relative;display:inline-block;height:34px;line-height:34px}.m-calendar__day.is-today{color:#21a497}.m-calendar__day.is-selected{color:#fff!important}.m-calendar__selected-day{display:none;position:absolute;z-index:-1;top:50%;left:50%;width:34px;height:34px;margin-top:-17px;margin-left:-17px;border-radius:50%}"]}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:a.Inject,args:[a.LOCALE_ID]}]},{type:undefined,decorators:[{type:a.Inject,args:[s]}]}]},e.propDecorators={side:[{type:a.Input}],period:[{type:a.Input}],events:[{type:a.Input}],hoveredDate:[{type:a.Input}]},e}(),p=r,u=[{start:p().startOf("day"),end:p().endOf("day"),code:"TODAY"},{start:p().subtract(1,"day").startOf("day"),end:p().subtract(1,"day").endOf("day"),code:"YESTERDAY"},{start:p().subtract(2,"day").startOf("day"),end:p().subtract(2,"day").endOf("day"),code:"DAY_BEFORE_YESTERDAY"},{start:p().startOf("isoWeek").startOf("day"),end:p().endOf("day"),code:"CURRENT_WEEK"},{start:p().startOf("month"),end:p().endOf("day"),code:"CURRENT_MONTH"},{start:p().startOf("quarter"),end:p().endOf("day"),code:"CURRENT_QUARTER"},{start:p().startOf("year"),end:p().endOf("day"),code:"CURRENT_YEAR"},{start:p().subtract(1,"w").startOf("isoWeek"),end:p().subtract(1,"w").endOf("isoWeek"),code:"PAST_WEEK"},{start:p().subtract(1,"M").startOf("month"),end:p().subtract(1,"M").endOf("month"),code:"PAST_MONTH"},{start:p().subtract(1,"y").startOf("year"),end:p().subtract(1,"y").endOf("year"),code:"PAST_YEAR"},{start:p().subtract(7,"d").startOf("day"),end:p().endOf("day"),code:"LAST_7_DAYS"},{start:p().subtract(30,"d").startOf("day"),end:p().endOf("day"),code:"LAST_30_DAYS"},{start:p().subtract(60,"d").startOf("day"),end:p().endOf("day"),code:"LAST_60_DAYS"},{start:p().subtract(3,"M").startOf("day"),end:p().endOf("day"),code:"LAST_QUARTER"},{start:p().subtract(6,"M").startOf("day"),end:p().endOf("day"),code:"LAST_6_MONTHS"},{start:p().subtract(1,"y").startOf("day"),end:p().endOf("day"),code:"LAST_YEAR"},{start:p().subtract(2,"y").startOf("day"),end:p().endOf("day"),code:"LAST_2_YEARS"}],h=r,f=function(){function e(e){this.defaults=e,this.presets=u,this.tab=2,this.chunkSize=Math.ceil(this.presets.length/2),this.datesChanged=new a.EventEmitter,this.events={topics:{},on:function(e,t){this.topics[e]||(this.topics[e]=[]),this.topics[e].push(t)},send:function(e,t){this.topics[e]&&this.topics[e].forEach(function(e){e(t)})}},this.visible=!1}return e.prototype.show=function(){this.visible=!0},e.prototype.hide=function(){this.visible=!1,this.presets.forEach(function(e){return e.hovered=!1})},e.prototype.init=function(){var t=this,r=0;this.events.on("updateModel",function(e){0===r&&(t.period.start=e.valueOf(),t.period.end=null),1===r&&(e.valueOf()<t.period.start.valueOf()?(t.period.end=h(t.period.start).endOf("day").valueOf(),t.period.start=e.valueOf()):t.period.end=e.endOf("day").valueOf()),t.period.start&&t.period.end&&(t.hide(),t.datesChanged.emit(t.period)),2===++r&&(r=0)}),this.events.on("hovered",function(e){t.hoveredDate=e})},e.prototype.onClick=function(e){e.stopPropagation()},e.prototype.setPeriod=function(e){this.period.start=this.getPresetValueByCode(e,"start"),this.period.end=this.getPresetValueByCode(e,"end"),this.hide(),this.datesChanged.emit(this.period)},e.prototype.getPresetValueByCode=function(t,e){return this.presets.find(function(e){return e.code===t})[e].valueOf()},e.decorators=[{type:a.Component,args:[{selector:"sgv-rangepicker",template:'<div class="m-calendar-wrapper" *ngIf="visible">\r\n    <header class="m-calendar-wrapper__header" [ngStyle]="{\'background-color\': defaults.color}">\r\n        <ul>\r\n            <li [ngClass]="{\'is-active\': tab === 1}" (click)="tab = 1">\r\n                {{ \'PRESETS\' | translate }}\r\n            </li>\r\n            <li [ngClass]="{\'is-active\': tab === 2}" (click)="tab = 2">\r\n                {{ \'DATE_INTERVAL\' | translate}}\r\n            </li>\r\n        </ul>\r\n    </header>\r\n    <div class="m-calendar-wrapper__inner">\r\n        <div *ngIf="tab === 1" class="m-calendar-wrapper__presets">\r\n            <div class="m-calendar-wrapper__row">\r\n                <div class="m-calendar-wrapper__col">\r\n                    <ul>\r\n                        <li *ngFor="let preset of presets | slice :  0 : chunkSize"\r\n                            [ngStyle]="preset.hovered ? {\'color\':  defaults.color } : {}"\r\n                            (click)="setPeriod(preset.code);"\r\n                            (mouseover)="preset.hovered=true"\r\n                            (mouseleave)="preset.hovered=false">\r\n                            {{ preset.code | translate }}\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div class="m-calendar-wrapper__col">\r\n                    <ul>\r\n                        <li *ngFor="let preset of presets | slice : chunkSize: presets.length"\r\n                            [ngStyle]="preset.hovered ? {\'color\':  defaults.color } : {}"\r\n                            (click)="setPeriod(preset.code);"\r\n                            (mouseover)="preset.hovered=true"\r\n                            (mouseleave)="preset.hovered=false">\r\n                            {{ preset.code | translate}}\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n        <div class="m-calendar-wrapper__row" *ngIf="tab === 2">\r\n            <div class="m-calendar-wrapper__col">\r\n                <sgv-calendar side="left" [period]="period" [events]="events" [hoveredDate]="hoveredDate"></sgv-calendar>\r\n            </div>\r\n            <div class="m-calendar-wrapper__col">\r\n                <sgv-calendar side="right" [period]="period" [events]="events" [hoveredDate]="hoveredDate"></sgv-calendar>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n',styles:[".m-calendar-wrapper{position:absolute;z-index:1000;top:40px;left:0;width:530px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid #eee;border-radius:2px;background:#fff;box-shadow:0 15px 79.38px 1.62px rgba(0,0,0,.16)}.m-calendar-wrapper--single{width:285px}.m-calendar-wrapper__row{margin:0 -10px}.m-calendar-wrapper__row:after{display:table;clear:both;content:''}.m-calendar-wrapper__col{float:left;box-sizing:border-box;width:50%;padding:0 10px}.m-calendar-wrapper__inner{padding:20px 20px 40px}.m-calendar-wrapper__header{height:70px;line-height:67px;box-shadow:0 2px 2.82px .18px rgba(0,0,0,.24)}.m-calendar-wrapper__header ul{display:table;width:100%;margin:0;padding:0}.m-calendar-wrapper__header li{display:table-cell;width:50%;font-size:14px;cursor:pointer;text-align:center;text-transform:uppercase;color:#fff}.m-calendar-wrapper__header li.is-active{border-bottom:3px solid #fff}.m-calendar-wrapper__presets{padding:20px 0;font-size:14px;font-weight:300;line-height:2}.m-calendar-wrapper__presets ul{margin:0;padding:0}.m-calendar-wrapper__presets li{padding:0 20px;list-style:none;cursor:pointer}"]}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:a.Inject,args:[s]}]}]},e.propDecorators={datesChanged:[{type:a.Output}],onClick:[{type:a.HostListener,args:["click",["$event"]]}]},e}(),g={PRESETS:{en:"Presets",ru:"Предустановленные"},DATE_INTERVAL:{en:"Date interval",ru:"Интервал дат"},TODAY:{en:"Today",ru:"Сегодня"},YESTERDAY:{en:"Yesterday",ru:"Вчера"},DAY_BEFORE_YESTERDAY:{en:"Day before yesterday",ru:"Позавчера"},CURRENT_WEEK:{en:"Current week",ru:"Текущая неделя"},CURRENT_MONTH:{en:"Current month",ru:"Текущий месяц"},CURRENT_QUARTER:{en:"Current quarter",ru:"Текущий квартал"},CURRENT_YEAR:{en:"Current year",ru:"Текущий год"},PAST_WEEK:{en:"Past week",ru:"Предыдущая неделя"},PAST_MONTH:{en:"Past month",ru:"Предыдущий месяц"},PAST_YEAR:{en:"Past year",ru:"Предыдущий год"},LAST_15_MIN:{en:"Last 15 minutes",ru:"Последние 15 минут"},LAST_30_MIN:{en:"Last 30 minutes",ru:"Последние 30 минут"},LAST_HOUR:{en:"Last hour",ru:"Последний час"},LAST_4_HOURS:{en:"Last 4 hours",ru:"Последние 4 часа"},LAST_12_HOURS:{en:"Last 12 hours",ru:"Последние 12 часов"},LAST_24_HOURS:{en:"Last 24 hours",ru:"Последние 24 часа"},LAST_7_DAYS:{en:"Last 7 days",ru:"Последние 7 дней"},LAST_30_DAYS:{en:"Last 30 days",ru:"Последние 30 дней"},LAST_60_DAYS:{en:"Last 60 days",ru:"Последние 60 дней"},LAST_QUARTER:{en:"Last quarter",ru:"Последний квартал"},LAST_6_MONTHS:{en:"Last 6 months",ru:"Последние 6 месяцев"},LAST_YEAR:{en:"Last year",ru:"Последний 1 год"},LAST_2_YEARS:{en:"Last 2 years",ru:"Последние 2 года"}},y=function(){function e(e){this.locale=e}return e.prototype.transform=function(e){return g[e][this.locale]||e},e.decorators=[{type:a.Pipe,args:[{name:"translate"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:a.Inject,args:[a.LOCALE_ID]}]}]},e}(),v=function(){function e(){}return e.decorators=[{type:a.NgModule,args:[{imports:[n.CommonModule],declarations:[d,l,f,y],exports:[d,f],providers:[s,{provide:a.LOCALE_ID,useValue:"en"}]}]}],e}();e.SgvRangepickerModule=v,e.SgvRangepickerDirective=d,e.SgvCalendarComponent=l,e.SgvRangepickerComponent=f,e.SgvTranslatePipe=y,e.SgvRangepickerOptions=i,e.ɵa=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sgv-rangepicker.umd.min.js.map